openapi: 3.0.0
info:
  title: Albion Awards - Email Registration API
  description: API para registro de emails en la landing de pre-lanzamiento
  version: 1.0.0
  contact:
    name: Albion Awards Team
    url: https://albionawards.com

servers:
  - url: https://albionawards.com/api
    description: Production server (Hostinger)
  - url: http://localhost:8000/api
    description: Local development server

paths:
  /emails:
    post:
      summary: Register email for launch notification
      description: |
        Registra un email para recibir notificación cuando se lance la votación.
        - Rate limit: 5 requests/minute por IP
        - Validación de formato de email
        - Prevención de duplicados
      operationId: registerEmail
      tags:
        - Email Registration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmailSubmissionRequest'
            examples:
              validEmail:
                summary: Valid email submission
                value:
                  email: usuario@ejemplo.com
              invalidEmail:
                summary: Invalid email format
                value:
                  email: not-an-email
      responses:
        '200':
          description: Email registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
              examples:
                success:
                  summary: Successful registration
                  value:
                    success: true
                    message: Email registrado exitosamente
        '400':
          description: Invalid request (bad email format)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidEmail:
                  summary: Invalid email format
                  value:
                    success: false
                    message: Formato de email inválido
                    error_code: INVALID_EMAIL
                emptyEmail:
                  summary: Empty email field
                  value:
                    success: false
                    message: El campo email es requerido
                    error_code: MISSING_FIELD
        '409':
          description: Email already registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                duplicate:
                  summary: Duplicate email
                  value:
                    success: false
                    message: Este email ya está registrado
                    error_code: EMAIL_EXISTS
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                rateLimited:
                  summary: Too many requests
                  value:
                    success: false
                    message: Demasiadas solicitudes. Intenta más tarde.
                    error_code: RATE_LIMIT_EXCEEDED
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                serverError:
                  summary: Server error
                  value:
                    success: false
                    message: Error interno del servidor
                    error_code: INTERNAL_ERROR

  /health:
    get:
      summary: Health check endpoint
      description: Verifica que la API esté funcionando correctamente
      operationId: healthCheck
      tags:
        - System
      responses:
        '200':
          description: API is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [ok]
                  timestamp:
                    type: string
                    format: date-time
              example:
                status: ok
                timestamp: '2025-11-11T10:30:00Z'

components:
  schemas:
    EmailSubmissionRequest:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          maxLength: 255
          description: Email address to register
          example: usuario@ejemplo.com

    SuccessResponse:
      type: object
      required:
        - success
        - message
      properties:
        success:
          type: boolean
          enum: [true]
          description: Indicates successful operation
        message:
          type: string
          description: Human-readable success message
          example: Email registrado exitosamente

    ErrorResponse:
      type: object
      required:
        - success
        - message
      properties:
        success:
          type: boolean
          enum: [false]
          description: Indicates failed operation
        message:
          type: string
          description: Human-readable error message
          example: Formato de email inválido
        error_code:
          type: string
          enum:
            - INVALID_EMAIL
            - EMAIL_EXISTS
            - MISSING_FIELD
            - RATE_LIMIT_EXCEEDED
            - INTERNAL_ERROR
          description: Machine-readable error code for client-side handling
          example: INVALID_EMAIL

  securitySchemes: {}

tags:
  - name: Email Registration
    description: Endpoints for email registration
  - name: System
    description: System health and monitoring endpoints
